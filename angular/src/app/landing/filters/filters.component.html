<div [ngStyle]="{'width': filterWidthNum+'px', 'overflow':'hidden'}">
    <div class="normalFilter" [hidden]="!isActive && !mobileMode" id="activeFilter" style="height:auto;padding-bottom: 1em;">
        <div>
            <!-- Filter header -->
            <div id="filterHeader" *ngIf="isActive || mobileMode" style="overflow: auto;">
                <a id="filtersLabel">Filters </a> <a
                    class="btn-sm collapsed in" (click)="this.isActive = !this.isActive;setColumnWidth()" data-toggle="collapse"
                    style="border-color: #025277; color: #FFF;padding: 0em;border: 0em"
                    data-target="#demo"><i [ngClass]="getFilterImgClass()"
                        style="zoom: 100%;color: #fff;cursor: pointer;"></i></a>
                <a href="#" id="clear-all"
                    (click)="$event.preventDefault();clearFilters()">
                    <i style="vertical-align: middle;zoom: 70%;margin-right: .3em;" class="faa faa-remove">
                    </i>Clear All</a>
            </div>
            
            <!-- Filter body -->
            <!-- Display spinner while waiting for search result -->
            <div class="spinner" *ngIf="searching">
                <i class="faa faa-spinner faa-spin faa-stack-2x" style="color:#1E6BA1;" aria-hidden="true"></i>
            </div>

            <div style="padding-left: -1em;" *ngIf="isActive && !searching">
                <!-- Forensics Research topics -->
                <div class="bottom-line" *ngIf="forensicsThemesTree.length > 0">
                    <div class="filter-checkbox">
                        <div [@expand]="forensicsShowMoreLink ? 'collapsed':'expanded'" >
                            <p-tree id="forensicsThemes" [value]="forensicsThemesTree" selectionMode="checkbox" [style]="researchTopicStyle" [(selection)]="forensicsSelectedThemesNode" 
                                (onNodeUnselect)="filterResults()"
                                (onNodeSelect)="filterResults()" 
                                (onNodeExpand)="nodeExpanded = true"
                                (onNodeCollapse)="nodeExpanded = false">
                                <ng-template let-node pTemplate="default">
                                    <span *ngIf="node.label.split('-')[1] !=''; else header1" class="invisible-scrollbar"> {{node.label.split("-")[0]}}&nbsp;</span>
                                    <ng-template #header1>
                                        <span><b> {{node.label.split("-")[0]}}&nbsp;</b></span>
                                    </ng-template>

                                    <span class="w3-badge badge-notify badge-style"
                                         *ngIf="node.label.split('-')[1] !=''">
                                        {{node.label.split("-")[1]}}</span>
                                </ng-template>
                            </p-tree>
                        </div>
                    </div>
                    <div class="show-more-less" (click)="$event.preventDefault(); forensicsShowMoreLink = false"
                        *ngIf="nodeExpanded == true && forensicsShowMoreLink == true && forensicsThemesTree[0]?.children.length > 5">Show More...
                    </div>
                    <div class="show-more-less" (click)="$event.preventDefault();forensicsShowMoreLink = true"
                        *ngIf="nodeExpanded == true && forensicsShowMoreLink == false && forensicsThemesTree[0]?.children.length > 5">Show Less
                    </div>
                </div>

                <!-- NIST Research topics -->
                <div class="bottom-line">
                    <div class="filter-checkbox">
                        <div [@expand]="showMoreLink ? 'collapsed':'expanded'">
                            <p-tree id="themes" [value]="themesTree" selectionMode="checkbox" [style]="researchTopicStyle" [(selection)]="selectedThemesNode" 
                                (onNodeUnselect)="filterResults()"
                                (onNodeSelect)="filterResults()" 
                                (onNodeExpand)="nodeExpanded = true"
                                (onNodeCollapse)="nodeExpanded = false">
                                <ng-template let-node pTemplate="default">
                                    <span *ngIf="node.label.split('-')[1] !=''; else header1" class="invisible-scrollbar"> {{node.label.split("-")[0]}}&nbsp;</span>
                                    <ng-template #header1>
                                        <span><b> {{node.label.split("-")[0]}}&nbsp;</b></span>
                                    </ng-template>

                                    <span class="w3-badge badge-notify badge-style"
                                        *ngIf="node.label.split('-')[1] !=''">
                                        {{node.label.split("-")[1]}}</span>
                                </ng-template>
                            </p-tree>
                        </div>
                    </div>
                    <div class="show-more-less" (click)="$event.preventDefault(); showMoreLink = false"
                        *ngIf="nodeExpanded == true && showMoreLink == true && themesTree[0]?.children.length > 5">Show More...
                    </div>
                    <div class="show-more-less" (click)="$event.preventDefault();showMoreLink = true"
                        *ngIf="nodeExpanded == true && showMoreLink == false && themesTree[0]?.children.length > 5">Show Less
                    </div>
                </div>

                <div *ngIf="theme=='ScienceTheme'" style="width: 100%;">
                    <span class="show-more-less" style="float: right;" (click)="toggleMoreOptions()">{{moreOptionsText}}</span>
                </div>

                <div style="overflow:hidden; width: 100%;">
                    <div [@expandOptions]="MoreOptionsDisplayed ? 'collapsed':'expanded'">
                        <!-- Resource type -->
                        <div class="filter-checkbox bottom-line">
                            <p-tree [value]="resourceTypeTree" selectionMode="checkbox" [style]="ResourceTypeStyle"
                                [(selection)]="selectedResourceTypeNode" 
                                (onNodeUnselect)="filterResults()"
                                (onNodeSelect)="filterResults()">
                                <ng-template let-node pTemplate="default">
                                    <span *ngIf="node.label.split('-')[1] !=''; else header2"> {{node.label.split("-")[0]}}&nbsp;</span>
                                    <ng-template #header2>
                                        <span><b> {{node.label.split("-")[0]}}&nbsp;</b></span>
                                    </ng-template>

                                    <span class="w3-badge badge-notify badge-style" 
                                        *ngIf="node.label.split('-')[1] !=''">
                                        {{node.label.split("-")[1]}}</span>
                                </ng-template>
                            </p-tree>
                        </div>
                        
                        <!-- Components -->
                        <div class="filter-checkbox bottom-line" *ngIf="componentsTree.length > 0">
                            <p-tree [value]="componentsTree" selectionMode="checkbox" [style]="recordHasStyle"
                                [(selection)]="selectedComponentsNode" (onNodeUnselect)="filterResults()"
                                (onNodeSelect)="filterResults()">
                                <ng-template let-node pTemplate="default">
                                    <span *ngIf="node.label.split('-')[1] !=''; else header3"> {{node.label.split("-")[0]}}&nbsp;</span>
                                    <ng-template #header3>
                                        <span><b> {{node.label.split("-")[0]}}&nbsp;</b></span>
                                    </ng-template>

                                    <span class="w3-badge badge-notify badge-style" 
                                        *ngIf="node.label.split('-')[1] !=''">
                                        {{node.label.split("-")[1]}}</span>
                                </ng-template>
                            </p-tree>
                        </div>
                    </div>
                </div>

                <!-- Authors and Contributors -->
                <div>
                    <div class="lbl-filter">
                        <label><b>Authors and Contributors</b></label>
                    </div>
                    <div class="filter-input p-fluid">
                        <label for="suggestedauthor" class="hideLabel">Search Input</label>
                        <p-autoComplete 
                            [(ngModel)]="selectedAuthor" 
                            inputId="suggestedauthor"
                            [suggestions]="suggestedAuthors" 
                            (completeMethod)="filterAuthors($event)" 
                            (onSelect)="filterResults()"
                            (onUnselect)="filterResults()"
                            [multiple]="true"
                            [minLength]="1"
                            [maxlength]="30" 
                            [style]="filterStyle">
                        </p-autoComplete>
                    </div>
                </div>

                <!-- Keyword -->
                <div>
                    <div class="lbl-filter">
                        <label><b>Keyword</b></label>
                    </div>
                    <div class="filter-input p-fluid">
                        <label for="keyword" class="hideLabel">Keyword</label>
                        <p-autoComplete 
                            inputId="keyword" 
                            [(ngModel)]="selectedKeywords"
                            [suggestions]="suggestedKeywords" 
                            (completeMethod)="filterKeywords($event)"
                            [multiple]="true" 
                            (onSelect)="filterResults()"
                            (onUnselect)="filterResults()" 
                            [minLength]="1"
                            [maxlength]="30" 
                            [style]="filterStyle"
                            [inputStyle]="{'width':'100%'}"
                            class="p-autocomplete">
                        </p-autoComplete>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div *ngIf="!searching && !isActive && !mobileMode" class="collapsedFilterBox" (click)="this.isActive = !this.isActive;setColumnWidth()">
        
        <!-- Collapsed filters -->
        <div >
            <i class="faa faa-angle-double-right collapsedFilterIcon"></i>
        </div>
        <div class="rotate rotatedFilterText"> Filters </div>
    </div>
</div>